<odoo>
    <data>
        <template id="report_kojto_delivery">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <div class="page">
                        <t t-set="company_contact" t-value="env['kojto.contacts'].search([('res_company_id', '=', env.company.id)], limit=1)" />
                        <t t-if="company_contact and company_contact.company_logo">
                            <t t-set="company_logo" t-value="'data:image/svg;base64,' + company_contact.company_logo.decode('utf-8')" />
                            <style> @page { @top-right { content: url("<t t-esc='company_logo' />"); width: 80px; vertical-align: bottom; padding-top: 20px; height: 100%; } } </style>
                        </t>
                        <div t-attf-style="string-set: timestamp '{{ datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S') }}';">
                            <h1 class="heading">
                                <span>Delivery </span>
                                <span t-field="doc.name" />
                            </h1>
                        </div>

                        <div class="info-section">
                            <div class="info-cell" t-if="doc.document_in_out_type == 'outgoing'">
                                <table class="info-table">
                                    <tr>
                                        <td class="label">Issued by:</td>
                                        <td class="content"><span t-field="doc.company_name_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Address:</td>
                                        <td class="content"><span t-field="doc.company_address_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Tax ID:</td>
                                        <td class="content" t-esc="doc.company_tax_number_id.name" />
                                    </tr>
                                    <tr>
                                        <td class="label">Reg. #:</td>
                                        <td class="content" t-esc="doc.company_registration_number" />
                                    </tr>
                                    <tr>
                                        <td class="label">Email:</td>
                                        <td class="content"><span t-field="doc.company_email_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Phone:</td>
                                        <td class="content"><span t-field="doc.company_phone_id" /></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="info-cell" t-if="doc.document_in_out_type == 'outgoing'">
                                <table class="info-table">
                                    <tr>
                                        <td class="label">Issued to:</td>
                                        <td class="content"><span t-field="doc.counterparty_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Address:</td>
                                        <td class="content"><span t-field="doc.counterparty_address_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Tax ID:</td>
                                        <td class="content" t-esc="doc.counterparty_tax_number_id.name" />
                                    </tr>
                                    <tr>
                                        <td class="label">Reg. #:</td>
                                        <td class="content" t-esc="doc.counterparty_registration_number" />
                                    </tr>
                                    <tr>
                                        <td class="label">Email:</td>
                                        <td class="content"><span t-field="doc.counterparty_email_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Phone:</td>
                                        <td class="content"><span t-field="doc.counterparty_phone_id" /></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="info-cell" t-if="doc.document_in_out_type == 'incoming'">
                                <table class="info-table">
                                    <tr>
                                        <td class="label">Issued by:</td>
                                        <td class="content"><span t-field="doc.counterparty_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Address:</td>
                                        <td class="content"><span t-field="doc.counterparty_address_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Tax ID:</td>
                                        <td class="content" t-esc="doc.counterparty_tax_number_id.name" />
                                    </tr>
                                    <tr>
                                        <td class="label">Reg. #:</td>
                                        <td class="content" t-esc="doc.counterparty_registration_number" />
                                    </tr>
                                    <tr>
                                        <td class="label">Email:</td>
                                        <td class="content"><span t-field="doc.counterparty_email_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Phone:</td>
                                        <td class="content"><span t-field="doc.counterparty_phone_id" /></td>
                                    </tr>
                                </table>
                            </div>
                            <div class="info-cell" t-if="doc.document_in_out_type == 'incoming'">
                                <table class="info-table">
                                    <tr>
                                        <td class="label">Issued to:</td>
                                        <td class="content"><span t-field="doc.company_name_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Address:</td>
                                        <td class="content"><span t-field="doc.company_address_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Tax ID:</td>
                                        <td class="content" t-esc="doc.company_tax_number_id.name" />
                                    </tr>
                                    <tr>
                                        <td class="label">Reg. #:</td>
                                        <td class="content" t-esc="doc.company_registration_number" />
                                    </tr>
                                    <tr>
                                        <td class="label">Email:</td>
                                        <td class="content"><span t-field="doc.company_email_id" /></td>
                                    </tr>
                                    <tr>
                                        <td class="label">Phone:</td>
                                        <td class="content"><span t-field="doc.company_phone_id" /></td>
                                    </tr>
                                    <tr>

                                    </tr>
                                </table>
                            </div>
                        </div>

                        <div class="body">
                            <table class="references-table">
                                <tr>
                                    <td class="label">Delivery Date:</td>
                                    <td class="content">
                                        <span t-if="doc.date_delivery" t-esc="doc.date_delivery.strftime('%d.%m.%Y')"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label">Delivery Address:</td>
                                    <td class="content">
                                        <span t-if="doc.delivery_address" t-esc="doc.delivery_address"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label">Incoterms:</td>
                                    <td class="content">
                                        <span t-if="doc.incoterms_id" t-esc="doc.incoterms_id.name"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label">Incoterms Address:</td>
                                    <td class="content">
                                        <span t-if="doc.incoterms_address" t-esc="doc.incoterms_address"/>
                                    </td>
                                </tr>
                            </table>
                            <div t-esc="doc.pre_content_text" style="white-space: pre-wrap;" />
                            <table class="content-table">
                                <thead>
                                    <tr>
                                        <th>â„–</th>
                                        <th>Description</th>
                                        <th style="text-align: right">Quantity</th>
                                        <th style="text-align: right">Unit Weight</th>
                                        <th style="text-align: right">Total Weight</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="doc.content.sorted(lambda x: x.position or 0)" t-as="line">
                                        <tr>
                                            <td t-esc="line.position if line.position else ''" />
                                            <td t-esc="line.name if line.name else ''" />
                                            <td style="text-align: right">
                                                <t t-set="translated_unit_name"
                                                    t-value="line.unit_id.translation_ids.filtered(lambda t: t.language_id.code == env.context.get('lang', 'en_US')).name or line.unit_id.name" />
                                                <t t-esc="'%.2f %s' % (line.quantity, translated_unit_name) if line.quantity or line.quantity == 0 else ''" />
                                            </td>
                                            <td style="text-align: right" t-esc="'%.2f' % line.unit_weight if line.unit_weight else ''" />
                                            <td style="text-align: right">
                                                <t t-esc="'%.2f kg' % line.net_weight if line.net_weight else ''" />
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                            <div t-esc="doc.post_content_text" style="white-space: pre-wrap;" />
                            <div style="page-break-inside: avoid; display: inline-block; width: 100%;">
                                <table class="totals-table">
                                    <tr>
                                        <td>Net Weight:</td>
                                        <td t-esc="'%.2f kg' % doc.net_weight" />
                                    </tr>
                                    <tr>
                                        <td>Tare Weight:</td>
                                        <td t-esc="'%.2f kg' % doc.tare_weight" />
                                    </tr>
                                    <tr>
                                        <td><strong>Gross Weight:</strong></td>
                                        <td><strong t-esc="'%.2f kg' % doc.gross_weight" /></td>
                                    </tr>
                                </table>
                            </div>
                        </div>


                        <!-- Footer -->
                        <div class="footer-section">
                            <p>Thank you for your business!</p>
                        </div>
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>
